## Foresight
- 论文名称：Foresight-a generative pretrained transformer for modelling of patient timelines using electronic health records a retrospective modelling study
### 一、目的
- 基于电子健康记录的患者时间线时序建模，并预测未来相关医学事件（包括疾病、医疗操作、物质相关时间等，都是从医疗预料库中抽取）。
- 三个重点：  
①电子健康记录，包括结构化数据（例如年龄、性别等个人资料，血常规等量化实验数据）和非结构化数据（例如影响报告、医生诊疗报告等没有统一结构的，不好直接输入给计算机的数据）。目前对非结构化数据处理不怎么好，但重要信息都出自这里，所以此模型想要设计一个能将非结构化数据转为结构编码的方法。  
②时间线时序建模。模型需要聚焦时间线。  
③预测未来事件。目前模型最多预测未来几个月的事件，此模型想要设计一个预测事件更长远的方法。
### 二、主要架构
#### 1.数据检索与预处理
- 论文中主要使用3个数据集（KCH、SLaM、MIMIC-III），先从中提取EHR（患者电子健康记录）的数据。
#### 2.非结构数据转化为结构编码（MedCAT）
- 其中一个核心，用MedCAT将非结构化数据转化为结构编码，和结构数据共同组成输入的时间线序列。
#### 3.因果语言建模，自回归生成（GPT-2）
- GPT-2采用decoder架构，简单来说就是通过前面的序列生成后续token（从词库中抽取预测概率最大的，一开始随机抽取）。
- 对比bert等双向掩码：双向掩码由于可以看到未来信息，有作弊的可能性，最后泛化能力可能不强。
- 对比lstm（长短时神经网络）：在MIMIC数据集上GPT-2比它的准确率高出了40%左右（论文数据）。lstm对于时间线敏感，可解释性强，在时间线不是特别长且数据量小的情况下表现可能会比较好；GPT-2可解释性差（只是算下一个词的概率），但在数据量大的时候准确率可观。
#### 3.可视化web
- 链接：https://foresight.sites.er.kcl.ac.uk/
- 提供交互功能，手动添加时间线并查看预测结构。
### 三、论文总结
- 主要重点在于**非结构化数据处理**（MedCAT）以及**模型构建**（GPT-2）
- 自己粗略实验结果：用压缩版本的MIMIC数据集，775个样本，训练20轮后，GPT-2比LSTM准确率高41.2%；改成200后，GPT-2比LSTM低73.3%。